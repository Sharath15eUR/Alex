The Pairwise Master Key (PMK) plays a critical role in the 4-way handshake process in Wi-Fi security, particularly in WPA2 and WPA3. The PMK is a shared secret between the client (supplicant) and the Access Point (AP), derived from the authentication process. It is generated either through a pre-shared key (PSK) in personal mode or via an EAP-based authentication method in enterprise mode. The PMK is not directly transmitted over the air during the handshake but is used as the basis to derive additional keys used for encryption and integrity checks during communication.

During the 4-way handshake, the PMK is used to derive two important keys: the Pairwise Transient Key (PTK) and the Group Temporal Key (GTK). The PTK is used to encrypt the data frames between the client and the AP, ensuring confidentiality, while the GTK is used to encrypt multicast and broadcast traffic, ensuring group security. The 4-way handshake ensures that both the client and the AP derive the same keys (PTK and GTK) based on the PMK, but they do so without actually transmitting the PMK over the network, enhancing security.

The purpose of the PMK in this process is to ensure that both parties—client and AP—have a common, pre-established secret that they can use to derive the session-specific keys securely. This process helps protect the communication from attacks like man-in-the-middle and ensures that encryption keys used during the session are unique to the specific client-AP association, enhancing the overall security of the wireless network.